Downloading and Visualizing NYISO Actual Load and Forecast Data
===============================================================

This repository contains a set of Python scripts used to massively download, organize and plot load and load forecast data from NYISO. **For simplifying the distribution of the code, the repository does not include data. It is recommended to store it in a subfolder called `00_NYISO_Data`.**

Examples of the use of the scripts are found in the Jupyter Notebook `01_Examples.ipynb`. For quick reference, the regions of the New York State grid are:

- `CAPITL`
- `CENTRL`
- `DUNWOD`
- `GENESE`
- `HUD VL`
- `LONGIL`
- `MHK VL`
- `MILLWD`
- `N.Y.C.` (be careful with the last colon after the 'C')
- `NORTH`
- `WEST`
- `NYISO` (aggregate of all zones of NYS grid)

In old files (prior to 2004), `NYC` and `LONGIL` were lumped into a single area: `N.Y.C._LONGIL`. The visualization function might not work in such cases.

Below is a list of the signatures of the functions in the repository:

- `download_nyiso_data(start_year, destination_folder, print_info = False)`: this function downloads all the '.csv' files of load forecast and actual load (hourly time-stamp) from the NYISO website from a given start year up to present time. It can be used to update existing files (i.e., does not overwrite pre-existing data). It also organizes the files in Pandas dataframes stored as pickle files (`.pkl`) by region of the New York State grid.

- `visualize_load_forecast(date, zone, data_path, show_plot = False)`: this function plots the actual load, most recent load forecast (labeled as 'best'), oldest load forecast (called 'worst'), and forecast error of the given date using the processed pickle files created by `download_nyiso_data`. As an optional return value, it gives the time stamps, the actual load and the forecast values as lists.

- `get_weekly_behavior(date, zone, data_path, show_plot = False)`: this method plots a weekly behavior of a given zone of the New York grid showing actual load, load forecast (best and worst) and forecast error. The resulting figures are exported as '`.png`' files as well.

- `compare_weekly_behavior(date, [comparison_years], zone, data_path)`: this function compares the weekly behavior of actual load, and best/worst load forecast of equivalent weeks in different years through a plot. 

- `get_monthly_behavior(date, zone, data_path, show_plot = False)`: this function returns the monthly information about load and load forecast for all weeks in a given month. A month is assumed to start the week at which the first day of the month takes place (i.e., if the first day of a month is a Tuesday, then that week is counted as the first week of that month). It returns a dictionary having the information of the month in a concatenated array and the weekly information. 

- `compare_monthly_behavior(date, [comparison_years], zone, data_path)`: this function is used to perform a comparison between the monthly behavior in different years for actual load and forecast error. It outputs a dictionary containing the information of the years which were compared.

The plots generated by the provided notebook are stored under "00_NYISO_Data/Figs" as `.png` files.
